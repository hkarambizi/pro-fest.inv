<header>
<h3 class="display-4 center"><%= @order.role %></h3>
 <h5 class="display-2 center">Location: <%= @location.title %></h5>
 <%= link_to 'Back To Location', event_location_path(event_id: @location.event_id, id: @location), class: 'right btn waves-effect waves-light' %>
</header>


<% if @can_edit %>
<%= link_to 'Add Transaction', new_event_location_order_transaction_path(order_id: @order.id), class: 'center btn-large waves-effect waves-light' %>
<%= link_to 'Edit Order', edit_event_location_order_path(id: @order.id), class: 'center btn-large waves-effect waves-light' %>
<%end%>

<% if @can_submit %>
<%= button_to 'Submit Request', order_submit_path(@location.event, @location, @order), method: :post, class: 'right btn waves-effect waves-light' %>
<%end%>

<tr>
  <div class="center">
      <h4>[<%= @order.status %>] Order #<%= @order.id %></h4>
      <br>
      <bold> Message: <%= @order.message %></bold>
      <br>
      <hr/>
  </div>
</tr>

<% if @order.transactions.length > 0 %>
<tr>
<div class="card">
		<table class="centered highlighted">
  			<thead>

      <th>Item #</th>
      <th>Status</th>
      <th colspan="3">Item Title</th>
      <th>Qty</th>
      <th>From</th>
      <th>To</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @transactions.each do |transaction| %>
      <tr>
        <td><%= transaction.id %></td>

        <td><%= transaction.status %></td>

        <td colspan="3"><%= link_to transaction.item.product.name, event_location_order_transaction_path(@event, @location, @order, transaction) %></td>

        <td><%= transaction.qty %></td>

        <td>
        <% if transaction.origin_id %>
        <%= link_to Location.find(transaction.origin_id).title, location_inventory_path(transaction.origin_id) %>
        <% else %>
        <span>Searching..</span>
        <% end %>
        </td>

        <td>
          <% if transaction.dest_id %>
            <%= link_to Location.find(transaction.dest_id).title, location_inventory_path(transaction.dest_id)%>
          <% else %>
            <span>Searching..</span>
          <% end %>
        </td>

        <td>
          <% if @order.role == 'transfer' %>
            <% if !transaction.origin_id.nil? and !transaction.dest_id.nil? and ["pending", "in_progress"].include?(transaction.status) %>
              <span> Reserved <i class="fa fa-check-square-o" aria-hidden="true"></i></span>
            <% elsif transaction.origin_id.nil? %>
              <%= link_to find_items_path(@location.event, @location, @order, transaction), class: "zwaves-effect waves-light btn" do %>
              <i class="fa fa-cube">Find Item</i>
            <% end %>
          <% end %>
        <% end %>
        </td>

        <td>
          <%= link_to edit_event_location_order_transaction_path(@event, @location, @order, transaction) do %>
            <i class="fa fa-pencil" aria-hidden="true"></i>
          <%end%>
        </td>

        <td>
          <%= link_to event_location_order_transaction_path(@event, @location, @order, transaction), method: :delete, data: { confirm: 'Are you sure?' } do %>
            <i class="fa fa-trash" aria-hidden="true"></i>
          <% end %>
        </td>

      </tr>
    <% end %>
  </tbody>
</table>
<br>
</div>
<% end %>

<% if !@no_confirm %>
  <%= link_to 'verify order', order_verify_path(@location.event, @location, @order), method: :post, class: 'right btn waves-effect waves-light' %>
  <% end %>



